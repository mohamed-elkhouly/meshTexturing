function [Rp, Tp, R, t] = visualizevisionlab(f, v, intrinsics_rgb)
addpath('C:\Users\t.tsesmelis.LIGHT\Desktop\sync\radiosity_modeling\libs+tools\PnP\EPnP');

% ptCloud = pcread('../visionLab_Garching.ply');
% pcshow(ptCloud);

%load('../calibration/floor0cam0/calibrationSession.mat');
%cameraParams=calibrationSession.CameraParameters

figure, plot_vertices(v');

% room1 with panels
worldPts = ...
[ 25607.050781	13039.240234	740; ...
  26022.380859	12324.519531	740; ...
  26859.320313	12413.059570	740; ...
  27773.140625	12513.969727	740; ...
  28786.919922	12639.700195	0.00; ...
  28856.699219	12645.559570	0.00; ...
  25810.029297	11003.580078	1650; ...
  27004.230469    11131.200195    1650; ...
  27059.220703	11137.349609	1650; ...
  28252.859375	11260.700195	1650; ... 
  25815.869141	10948.889648	1650; ...
  26154.369141	10960.450195	740; ...
  26989.279297	11053.009766	740; ...
  27010.070313	11076.509766	1650; ...
  27064.869141	11082.639648	1650; ...
  27925.869141	11152.480469	740; ...
  28258.509766	11205.990234	1650; ...
  26294.789063	9632.374023	740; ...
  27133.589844	9720.535156	740; ...
  28067.210938	9821.925781	740];

% % room2 without panels
% worldPts = ...
% [ 26022.380859  12324.519531    740; ...
%   27773.140625  12513.969727    740; ...
%   26853.339844  12416.209961    740; ...
%   26944.269531  12425.799805    740; ...
%   26153.320313  11061.400391    740; ...
%   26992.119141  11149.559570    740; ...
%   27071.570313  11160.790039    740; ...
%   27910.369141  11248.950195    740; ...
%   26160.400391  10964.790039    740; ...
%   26988.009766  11051.769531    740; ...
%   27092.240234  11068.870117    740; ...
%   27919.859375  11155.849609    740; ...
%   26294.789063  9632.374023     740; ...
%   27129.900391  9715.060547     740; ...
%   27227.560547  9727.633789     740; ...
%   28061.179688  9811.246094     740; ...
%   25593.810547  13032.790039    0; ...
%   28744.570313  13087.719727    0; ...
%   28786.919922  12639.700195    0; ...
%   28414.349609  8822.411133     29.914101];

hold on;
plot3(worldPts(:,1),worldPts(:,2),worldPts(:,3),'r*');

worldPts_h = worldPts;
worldPts_h(:,4)=1;
%%%%here
unimgPts = ...
    [ 1045  387; ...
      1140  560; ...
      1362  560; ...
      1605  560; ...
      1752  627; ...
      1770  637; ...
      834   827; ...
      1370  830; ...
      1403  837; ...
      1971  846; ...
      834   854; ...
      1129  913; ...
      1361  915; ...
      1370  853; ...
      1403  860; ...
      1619  920; ...
      1971  873; ...
      1122  1267; ...
      1356  1274; ...
      1617  1285;
     ];
 
% % room2 without panels     
% unimgPts = ...
%     [ 1140  560; ...
%       1605  560; ...
%       1364  560; ...
%       1380  564; ...
%       1128  895; ...
%       1360  897; ...
%       1380  898; ...
%       1620  898; ...
%       1128  913; ...
%       1360  914; ...
%       1380  918; ...
%       1620  920; ...
%       1124  1268; ...
%       1360  1274; ...
%       1374  1278; ...
%       1620  1287; ...
%       1122  548; ...
%       1746  540; ...
%       1752  628; ...
%       1621  1428
%      ];
     
unimgPts_h = unimgPts;
unimgPts_h(:,3) = 1;

% [Rp,Tp,Xc,sol] = efficient_pnp(worldPts_h,unimgPts_h,intrinsics_rgb);
[R,t,Xc,sol]=efficient_pnp_gauss(worldPts_h,unimgPts_h,intrinsics_rgb);
[err1,Urep1]=reprojection_error_usingRT(worldPts,unimgPts,R,t,intrinsics_rgb);
T    = [R t; 0 0 0 1];
invT = inv(T);
Rp   = invT(1:3,1:3);
Tp   = invT(1:3,4);
%Tp=[25590.639999389648,13062.980468750000,740.000000000000;]'

hold on
% plotCamera('Size',50,'Orientation',Rp,'Location', Tp);
plotCamera(Rp,Tp,'r',50);
hold off

Xw=worldPts;
n=size(Xw,1);
%P=intrinsics_rgb*[T(1:3,1:3),T(1:3,4)];
P=intrinsics_rgb*[Rp,Tp];
Xw_h=[Xw,ones(n,1)];
Urep_=(P*Xw_h')';
Urep=zeros(n,2);
Urep(:,1)=Urep_(:,1)./Urep_(:,3);
Urep(:,2)=Urep_(:,2)./Urep_(:,3);
U=unimgPts_h;
err_=sqrt((U(:,1)-Urep(:,1)).^2+(U(:,2)-Urep(:,2)).^2);
err=sum(err_)/n;
end